# Human pluripotent stem cell-derived myogenic progenitor cells engraft to become quiescent functional satellite cells in vivo

### Introduction
In this study, we transplanted human pluripotent stem cell-derived myogenic progenitors (satellite cells) to injured muscle to look at engraftment and long-term regeneration. As part of the study, we performed single cell RNA-sequencing to compare the transcriptional profiles of transplanted satellite cells vs controls cultured in vitro. The full study can be found at (add when ready). Here, we share all of the data and code to reproduce our analysis.

### Data
All of the relevant files to reproduce the analysis can be downloaded at our [Synapse](https://www.synapse.org/#!Synapse:syn24178532/files/). In particular, the following files may be of relevance:

- `data_no_ercc.csv`, `data_w_ercc.csv`, `phenotype.csv`: These are the counts tables for the main data (including ESCs, cultured PSC-satellite cells, and transplanted PSC-satellite cells). The data was generated by mapping with zUMIs. Note - these counts tables use gene symbols for gene names; for those looking for the original ENSEMBL or the direct output of zUMIs, please contact me. `phenotype.csv` contains the metadata for all of the cells.

- `timepoint_data_no_ercc.csv`, `timepoint_data_w_ercc.csv`, `timepoint_phenotype.csv`: In addition to the above study, we also performed a second experiment as a time-series of transplantation, with cells harvest 1, 2, 3, and 4 weeks post-transplantation. These are the corresponding count tables and metadata.

- `Workspace_wo_SCN.RData`: A pre-made workspace that contains a lot of the likely objects of interest for users. This workspace was generated by running `SunnyAnalysisScript.R` (see below) without running the portions that involve comparison to other datasets from the literature. For users interested in that analysis, please download the code file and run those portions.

The following relevant files can be found on Github:

- `SunnyAnalysisScript.R`: An R file containing the entire analysis workflow for the manuscript. All of the files required to reproduce this workflow should be on the Synapse, and a significant chunk of this workflow has been run for `Workspace_wo_SCN.RData`.

### Dependencies
Most of the libraries used in our codebase can be found from CRAN or Bioconductor. However, we additionally make use of the SingleCellNet package from the Cahan lab. Please see [their github](https://github.com/pcahan1/singleCellNet) for instructions on how to install SingleCellNet.

### How to replicate our workflow
To replicate the workflow from the very top, please follow these steps:

1. Download `SunnyAnalysisScript.R`, and all of the files in the listed Synapse folder.

2. Modify the appropriate lines of both `SunnyAnalysisScript: `setwd("~/Documents/Research/SunnySun/FinalManuscript/")` to set the working directory to the same working directory you downloaded the Synapse files into it.

3. Run code for any workflow section or figure of interest.

Alternatively, note that you can start by loading `Workspace_wo_SCN.RData` into R or an IDE of your choice.

Please note that this was one of the first analyses I did, and as such, the code isn't the cleanest or most neatly organized. Please feel free to email or raise an issue if any of the code doesn't work, or if there is some other piece of data that you are looking for.
